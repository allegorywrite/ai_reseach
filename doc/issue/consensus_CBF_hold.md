# Consensus CBF (CCBF)の研究テーマへの適用に関する検討

## 現状の理解

現在の研究テーマでは、複数のUAVによる協調的なvisual-inertial SLAMシステムにおいて、視野錐台の交差を維持するためのactive perceptionアプローチを提案しています。特に、Control Barrier Functions (CBF)を用いて、エージェント間の視野錐台の交差を保証しながら、安全性（衝突回避）も同時に確保する制御手法の開発を目指しています。

一方で、Consensus-Based Control Barrier Function (CCBF)という概念があり、これが通常のCBFとどのように異なるのか、また本研究テーマにCCBFを適用することの意義や必要性について検討する必要があります。

## CCBFの理解（論文調査結果）

論文「Consensus-Based Control Barrier Function for Swarm」（Manao Machida and Masumi Ichien）を調査した結果、CCBFの特徴と通常のCBFとの違いが明らかになりました：

### CCBFの特徴

1. **分散システム全体の状態制約**: 個々のロボットだけでなく、スウォーム全体の状態を安全集合内に保つことができる
2. **局所通信のみで実現**: ロボット間の局所的な通信のみを用いて、全体の状態を制約できる
3. **コンセンサスフィルタによる近似**: バリア関数の値をコンセンサスフィルタによって近似する

### 通常のCBFとの違い

従来のスウォームにおけるCBFの研究は、主にロボット間の衝突回避や接続性維持に焦点を当てており、各ロボットの局所的な状態（自身の状態と近くのロボットの状態）のみに依存します。そのため、スウォーム全体の状態を制約することはできません。

一方、CCBFはスウォーム全体の状態に依存するバリア関数を分散システムで使用する方法を提供します。各ロボットがコンセンサスフィルタを用いて全体の状態を近似し、局所的な通信のみで制約を満たす制御入力を計算します。

## 研究テーマへの適用可能性

視野錐台の交差維持という目標は、本質的に複数のUAV間の協調を必要とします。CCBFを研究テーマに適用することで、以下のメリットが期待できます：

1. **分散制御の実現**: 
   - 各UAVが局所的な情報のみに基づいて意思決定を行いながらも、全体として視野錐台の交差を維持できる
   - 中央集権的な制御なしで、分散的に安全制約を満たす制御が可能になる

2. **全体状態への依存**:
   - 視野錐台の交差という、スウォーム全体の状態に依存する制約を扱うことができる
   - 例えば、「少なくとも2台のUAVが同じ特徴点を観測している」といった制約を表現できる

3. **通信制約への対応**:
   - 限られた通信帯域幅や遅延がある状況でも、効率的に協調制御を実現できる
   - コンセンサスフィルタを用いることで、少ない通信量で全体の状態を近似できる

4. **ロバスト性の向上**:
   - 一部のUAVの故障や通信途絶が発生した場合でも、システム全体としての機能を維持できる
   - 冗長性を持たせることで、システムの信頼性が向上する

5. **理論的保証**:
   - CCBFの理論的保証（前方不変性）により、視野錐台の交差維持が数学的に保証される
   - 安全性（衝突回避）と視野制約を同時に満たすことが保証される

## 具体的な適用方法

研究テーマにCCBFを適用する具体的な方法として、以下が考えられます：

1. **視野錐台交差のためのバリア関数設計**:
   ```
   B(x) = \sum_{m \in M} \phi_m \left( \sum_{i \in R} \psi_{im}(x_i) \right)
   ```
   ここで、$\psi_{im}(x_i)$は各UAVの視野に関する情報を表し、$\phi_m$はそれらを組み合わせて視野錐台の交差を評価する関数

2. **コンセンサスフィルタの実装**:
   ```
   \dot{y}_{im} = k_L \sum_{j \in N_i} (y_{jm} - y_{im}) + \dot{\psi}_{im}(x_i)
   ```
   各UAVが局所的な通信を通じて、全体の視野状態を近似

3. **CBFコントローラの設計**:
   ```
   u_i(x_i) \in \arg\min_{u_i} \|u_i - k_i(x_i)\|^2
   \text{s.t.} \sum_{m \in M} \nabla \phi_m(ny_{im})^T \dot{\psi}_{im}(x_i) \geq \alpha \sum_{m \in M} \phi_m(ny_{im})
   ```
   視野錐台の交差を維持しながら、目標軌道に追従する制御入力を計算

## 今後の方針

CCBFの研究テーマへの適用可能性が高いことが確認できましたが、さらに詳細な検討が必要です：

1. サーベイリクエスト（task_2/request.md）を作成し、CCBFに関するより詳細な情報を収集
2. サーベイ結果に基づいて、CCBFの研究テーマへの適用方法を具体化
3. 視野錐台交差のためのバリア関数の設計と理論的検証
4. シミュレーションによる有効性の検証

## 保留理由

このissueは現時点では保留（hold）とします。その理由は：

1. CCBFに関するより詳細なサーベイ結果（task_2/answer.md）が必要
2. 視野錐台交差のためのバリア関数の具体的な設計が必要
3. CCBFを用いた場合の計算コストや実装の複雑さの評価が必要

サーベイ結果（task_2/answer.md）が得られ次第、このissueを再検討します。
